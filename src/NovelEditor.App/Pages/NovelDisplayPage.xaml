<Page
    x:Class="NovelEditor.Pages.NovelDisplayPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="using:NovelEditor.Pages"
    xmlns:models="using:NovelEditor.Data.Models"
    xmlns:controls="using:NovelEditor.UserControls.NovelControl"
    mc:Ignorable="d">

    <Page.Resources>
        <!-- 用于显示小说的 DataTemplate -->
        <DataTemplate x:Key="NovelCardTemplate" x:DataType="models:Novel">
            <controls:NovelItemControl Novel="{x:Bind}"
                                       Loaded="NovelItemControl_Loaded"
                                       Unloaded="NovelItemControl_Unloaded"/>
        </DataTemplate>

        <!-- 用于显示“创建小说”控件的 DataTemplate -->
        <DataTemplate x:Key="CreateCardTemplate" x:DataType="controls:CreateNovelControl">
            <ContentControl Content="{x:Bind}"/>
        </DataTemplate>

        <!-- 用于根据数据类型选择上述模板的选择器 -->
        <local:NovelTemplateSelector x:Key="MyTemplateSelector"
                                     NovelTemplate="{StaticResource NovelCardTemplate}"
                                     CreateTemplate="{StaticResource CreateCardTemplate}"/>
    </Page.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" Margin="0,0,0,24" FontSize="28" FontWeight="Bold" Text="我的小说" />

        <GridView
            x:Name="NovelsGridView"
            Grid.Row="1"
            Padding="0,0,12,12"
            HorizontalAlignment="Stretch"
            IsItemClickEnabled="False"
            ItemTemplateSelector="{StaticResource MyTemplateSelector}"
            SelectionMode="None">
            <GridView.ItemsPanel>
                <ItemsPanelTemplate>
                    <ItemsWrapGrid Orientation="Horizontal" />
                </ItemsPanelTemplate>
            </GridView.ItemsPanel>
            <GridView.ItemContainerStyle>
                <Style TargetType="GridViewItem">
                    <Setter Property="Padding" Value="8"/>
                    <Setter Property="Margin" Value="0"/>
                </Style>
            </GridView.ItemContainerStyle>
        </GridView>

        <ProgressRing x:Name="LoadingRing" Grid.Row="1" Width="60" Height="60" HorizontalAlignment="Center" VerticalAlignment="Center" IsActive="True" />

        <StackPanel x:Name="NoNovelsPanel" Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="12" Visibility="Collapsed">
            <SymbolIcon Symbol="Document" RenderTransformOrigin="0.5,0.5">
                <SymbolIcon.RenderTransform>
                    <ScaleTransform ScaleX="2" ScaleY="2" />
                </SymbolIcon.RenderTransform>
            </SymbolIcon>
            <TextBlock HorizontalAlignment="Center" FontSize="20" Text="书架空空如也" />
            <TextBlock HorizontalAlignment="Center" Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}" Text="点击左上角的卡片开始创作你的第一本小说吧！" />
        </StackPanel>

        <InfoBar x:Name="PageInfoBar" Grid.Row="1" VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,20" IsOpen="False" />
    </Grid>
</Page>
